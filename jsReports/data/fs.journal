{"operation":"update","timestamp":{"$$date":1725549825966},"version":8097,"doc":{"name":"printer_usage_pdf","engine":"handlebars","recipe":"chrome-pdf","data":{"shortid":"wEAQ4A6Iv"},"shortid":"HnSixVjW5","chrome":{"printBackground":true},"creationDate":{"$$date":1657631864808},"modificationDate":{"$$date":1725549825946},"_id":"XPsemHrgorVpoVML","$entitySet":"templates","content":"<html>\n<head>\n    <meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\">\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/metro/4.1.5/css/metro.min.css\">\n    <style>    \n        img {\n            with: 40px;\n            height: 40px;\n        }\n        .font-weight--bold {\n            font-weight: bold;\n        }\n        .total {\n            width: 254px; \n            text-align: right;\n        }\n        .total-row {\n            position: absolute;\n            bottom: 0;\n            width: 94%;\n            display: flex; \n            justify-content: space-between;\n        }\n    </style>\n\n        <style>\n        {#asset printer_usage.css @encoding=utf8}\n    </style>\n</head>\n<body class=\"px-8 mt-8\">\n      <p class=\"gray-color\">{{data.date}}</p>\n      <div class=\"row ml-0 mt-2\" style=\"justify-content: space-between\">\n        <h4>Printer Usage Summary Report</h4>\n        <img src=\"{{data.logo}}\"/>\n      </div>\n      {{#each data.Customers}}\n      <p class=\"mb-6\">{{CustomerName}}</p>\n     <table class='col1 sub-report-table mb-8'>\n            <thead class=\"border-none\">\n                <tr class=\"bg-row\">\n                    <th class=\"table-heading width-130px pl-3 padding-right-8px\">Printer</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">Color pages</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">GrayScale pages</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">Duplex pages</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">Total Printed Pages</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">Jobs</th>\n                    <th class=\"table-heading table-th right-aligned width-130px padding-right-8px\">Costs</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{#each PrinterData}}\n                <tr class=\"border-top-bottom\">\n                    <td class=\"font-weight--bold width-130px pl-3 padding-right-8px\">{{Printer}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{hasDecimal ColorPages ../../data.decimalSeparator}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{hasDecimal GrayScalePages  ../../data.decimalSeparator}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{hasDecimal DuplexPages  ../../data.decimalSeparator}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{hasDecimal TotalPrintedPages  ../../data.decimalSeparator}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{roundNumber Jobs ../../data.decimal ../../data.decimalSeparator}}</td>\n                    <td class=\"gray-color right-aligned width-130px padding-right-8px\">{{../../data.currency}}{{truncate Costs ../../data.decimal ../../data.decimalSeparator}}</td>\n                </tr>\n                {{/each}}\n                 <tr class=\"border-top\">\n                    <td class=\"font-weight--bold total width-130px padding-right-8px\">Total:</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{totalColorPages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{totalGrayScalePages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{totalDuplexPages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{totalPrintedPages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{totalJobsPages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                    <td class=\"gray-color bold right-aligned width-130px padding-right-8px\">{{../data.currency}}{{totalCostsPages PrinterData ../data.decimal ../data.decimalSeparator}}</td>\n                </tr>\n            </tbody>\n        </table>\n\n        {{/each}}\n        <script></script>\n  </body>\n</html>","helpers":"\n//global variables to calculate the grand total values\nvar totalColorPagesCount = 0;\nvar totalGrayScalePagesCount = 0;\nvar totalDuplexPagesCount = 0;\nvar totalPrintedCount = 0;\nvar totalJobsCount = 0;\nvar totalCostsCount = 0;\n\nfunction totalColorPages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.ColorPages;\n    })\n    totalColorPagesCount = sum;\n    var totalColor = hasDecimal(totalColorPagesCount, decimalSeparator)\n    return totalColor;\n}\n\nfunction totalGrayScalePages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.GrayScalePages;\n    })\n    totalGrayScalePagesCount = sum;\n    var totalGray = hasDecimal(totalGrayScalePagesCount, decimalSeparator)\n    return totalGray;\n}\n\n\nfunction truncate(cost, decimal, decimalSeparator) {\n    return Number(cost).toFixed(decimal).replace('.', decimalSeparator);\n}\n\n\nfunction totalPrintedPages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.TotalPrintedPages;\n    })\n    totalPrintedCount = sum;\n    var totalPrinted = hasDecimal(totalPrintedCount, decimalSeparator)\n    return totalPrinted;\n}\n\nfunction totalDuplexPages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.DuplexPages;\n    })\n    totalDuplexPagesCount = sum;\n    var totalDuplex = hasDecimal(totalDuplexPagesCount, decimalSeparator)\n    return totalDuplex;\n}\nfunction totalJobsPages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.Jobs;\n    })\n    totalJobsCount = sum;\n    return totalJobsCount.toFixed(decimal).replace('.', decimalSeparator);\n}\nfunction totalCostsPages(data, decimal, decimalSeparator) {\n    var sum = 0;\n    data.forEach(function(i) {\n        sum += +i.Costs;\n    })\n    totalCostsCount = sum;\n    return Number(totalCostsCount).toFixed(decimal).replace('.', decimalSeparator);\n}\n\nfunction roundNumber(number, decimal, decimalSeparator) {\n    const typeToNumber = Number(number);\n\n    return typeToNumber.toFixed(decimal).replace('.', decimalSeparator);\n}\n\nfunction styles(hex) {\n    return 'background-color:' + hex;\n}\n\nfunction hasDecimal(number, decimalSeparator) {\n    var valueNumber = Number(number)\n    var value = valueNumber?.toString().includes('.') ? valueNumber.toFixed(2).replace('.', decimalSeparator) : valueNumber\n    return value;\n}\n","folder":{"shortid":"Ct9Z6KM"},"$$etag":1725549825966}}
{"operation":"insert","timestamp":{"$$date":1725549828030},"version":8098,"doc":{"_id":"WZuXz6AjO8XEZMW9","timestamp":{"$$date":1725549827995},"state":"queued","mode":"standard","creationDate":{"$$date":1725549828002},"modificationDate":{"$$date":1725549828009},"shortid":"TX8Wn-z","$entitySet":"profiles"}}
{"operation":"update","timestamp":{"$$date":1725549828090},"version":8099,"doc":{"_id":"WZuXz6AjO8XEZMW9","timestamp":{"$$date":1725549827995},"state":"running","mode":"standard","creationDate":{"$$date":1725549828002},"modificationDate":{"$$date":1725549828057},"shortid":"TX8Wn-z","$entitySet":"profiles","$$etag":1725549828090,"timeout":60000,"templateShortid":"HnSixVjW5"}}
{"operation":"update","timestamp":{"$$date":1725549841829},"version":8100,"doc":{"_id":"WZuXz6AjO8XEZMW9","timestamp":{"$$date":1725549827995},"state":"success","mode":"standard","creationDate":{"$$date":1725549828002},"modificationDate":{"$$date":1725549841825},"shortid":"TX8Wn-z","$entitySet":"profiles","$$etag":1725549841829,"timeout":60000,"templateShortid":"HnSixVjW5","finishedOn":{"$$date":1725549841825},"blobName":"profiles/printer-reports/printerUsage/printer_usage_pdf/kslbb4xd5kmgi9f.log"}}
{"operation":"insert","timestamp":{"$$date":1725549857265},"version":8101,"doc":{"_id":"dfolT9JDbRAXLS7I","timestamp":{"$$date":1725549857255},"state":"queued","mode":"standard","creationDate":{"$$date":1725549857258},"modificationDate":{"$$date":1725549857258},"shortid":"lijX6UN","$entitySet":"profiles"}}
{"operation":"update","timestamp":{"$$date":1725549857277},"version":8102,"doc":{"_id":"dfolT9JDbRAXLS7I","timestamp":{"$$date":1725549857255},"state":"running","mode":"standard","creationDate":{"$$date":1725549857258},"modificationDate":{"$$date":1725549857273},"shortid":"lijX6UN","$entitySet":"profiles","$$etag":1725549857277,"timeout":60000,"templateShortid":"3QeAIzW"}}
{"operation":"update","timestamp":{"$$date":1725549861946},"version":8103,"doc":{"_id":"dfolT9JDbRAXLS7I","timestamp":{"$$date":1725549857255},"state":"success","mode":"standard","creationDate":{"$$date":1725549857258},"modificationDate":{"$$date":1725549861914},"shortid":"lijX6UN","$entitySet":"profiles","$$etag":1725549861946,"timeout":60000,"templateShortid":"3QeAIzW","finishedOn":{"$$date":1725549861914},"blobName":"profiles/printer-reports/printerUsage/printer_usage_html/91r6jr294w7hbly.log"}}
{"operation":"insert","timestamp":{"$$date":1725549869786},"version":8104,"doc":{"_id":"BJdpomEK7Hpein1k","timestamp":{"$$date":1725549869771},"state":"queued","mode":"standard","creationDate":{"$$date":1725549869774},"modificationDate":{"$$date":1725549869774},"shortid":"gv2K17z","$entitySet":"profiles"}}
{"operation":"update","timestamp":{"$$date":1725549869814},"version":8105,"doc":{"_id":"BJdpomEK7Hpein1k","timestamp":{"$$date":1725549869771},"state":"running","mode":"standard","creationDate":{"$$date":1725549869774},"modificationDate":{"$$date":1725549869793},"shortid":"gv2K17z","$entitySet":"profiles","$$etag":1725549869814,"timeout":60000,"templateShortid":"Ox9ju3B"}}
{"operation":"update","timestamp":{"$$date":1725549877075},"version":8106,"doc":{"_id":"BJdpomEK7Hpein1k","timestamp":{"$$date":1725549869771},"state":"success","mode":"standard","creationDate":{"$$date":1725549869774},"modificationDate":{"$$date":1725549877073},"shortid":"gv2K17z","$entitySet":"profiles","timeout":60000,"templateShortid":"Ox9ju3B","finishedOn":{"$$date":1725549877073},"blobName":"profiles/printer-reports/printerUsage/printer_usage_excel/6aae9u009gzveab.log","$$etag":1725549877075}}
